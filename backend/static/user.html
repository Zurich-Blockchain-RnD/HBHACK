<!-- 
    This file is hosted by an S3 Bucket and the CloudFont Service from AWS

    This file has a button from wich you can cliam an ctype (Currently only for testing, will be replaced by the the Angualr frontend)
 -->
<html>
    <head>
        <title></title>
        <script
        src="https://code.jquery.com/jquery-3.4.1.js"
        ></script>
        <script>



                $(document).ready(function(){
                    const url = 'https://9g17kjfeeh.execute-api.us-east-1.amazonaws.com/dev/user';
                    const token = getUrlParameter('token');
                    console.log(token);
                    $.ajax({
                        type: "POST",
                        url: url,
                        crossDomain: true,
                        contentType: "application/json",
                        dataType: 'json',
                        headers: { 'Authorization': token },
                        data: JSON.stringify({ }),
            
                    })
                    .done(function(data) {
                        console.log(data)
                    });
                
                });



            function getUrlParameter (sParam) {
                var sPageURL = window.location.search.substring(1),
                    sURLVariables = sPageURL.split('&'),
                    sParameterName,
                    i;
            
                for (i = 0; i < sURLVariables.length; i++) {
                    sParameterName = sURLVariables[i].split('=');
            
                    if (sParameterName[0] === sParam) {
                        return sParameterName[1] === undefined ? true : decodeURIComponent(sParameterName[1]);
                    }
                }
            };

            function claim() {
                console.log('Claim function got executed')
                const url = 'https://9g17kjfeeh.execute-api.us-east-1.amazonaws.com/dev/claim';
                const token = getUrlParameter('token');
                const claim = {
                    ctype: {
                        name: 'Max',
                        age: 18
                    }
                };
                console.log(token);
                $.ajax({
                    type: "POST",
                    url: url,
                    crossDomain: true,
                    contentType: "application/json",
                    dataType: 'json',
                    headers: { 'Authorization': token },
                    data: JSON.stringify(claim),
        
                })
                .done(function(data) {
                    console.log(data)
                });
            }
        </script>
    </head>

    <body>
        <button onclick="claim()">
            Claim
        </button>

    </body>
</html>